<script>
let count = 0;

const nameInput = document.getElementById('nameInput');
const button = document.getElementById('clickButton');
const counterDisplay = document.getElementById('counter');
const topList = document.getElementById('topList');

// Update leaderboard display
function updateLeaderboardDisplay(leaderboard) {
    topList.innerHTML = '';
    leaderboard.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.name}: ${item.score}`;
        topList.appendChild(li);
    });
}

// Fetch the latest leaderboard from backend
async function fetchLeaderboard() {
    try {
        const response = await fetch('http://localhost:30501/leaderboard'); // Replace with your LoadBalancer IP/port
        const data = await response.json();
        updateLeaderboardDisplay(data);
    } catch (err) {
        console.error('Failed to fetch leaderboard:', err);
    }
}

// Handle button clicks
button.addEventListener('click', async () => {
    const name = nameInput.value.trim();
    if (!name) {
        alert("Please enter your name before clicking!");
        return;
    }

    count += 1;
    counterDisplay.textContent = count;

    // bump animation
    counterDisplay.classList.add('bump');
    setTimeout(() => counterDisplay.classList.remove('bump'), 200);

    // Send click to backend
    try {
        const response = await fetch('http://localhost:30501/click', { // Replace with your LoadBalancer IP/port
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name })
        });
        const data = await response.json();

        // Update leaderboard from backend response
        updateLeaderboardDisplay(data.leaderboard);
    } catch (err) {
        console.error('Failed to send click:', err);
    }
});

// Initialize leaderboard on page load
fetchLeaderboard();
</script>


